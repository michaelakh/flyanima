<style>
    div.side-left {
        float:left;
        width:15%;
        max-width:300px;
        margin:20px 20px 0px 10px;
        overflow:hidden;
    }
    
    div.side-content{
        height:600px;
        padding:5px;
        border:solid 1px pink;
        border-radius:5px;
    }
    
    div.side-ads {
        height:300px;
        padding:5px;
        margin: 10px 0px 10px 0px;
        border:solid 1px pink;
        border-radius:5px;
    }
    
    div.side-right {
        float:left;
        width:20%;
        max-width:300px;
        margin:20px 0px 0px 10px;
        overflow:hidden;
    }
    
    div.middle {
        display:inline-block;
        float:left;
        width:60%;
        min-height:200px;
        max-width:900px;
        border: solid 1px black;
    }
    div .col-12 {
        width:100%;
        padding:10px;
    }

    div.col-6 {
        width:42%;
        padding:10px;
    }

    div.col-4 {
        width:20%;
        padding:10px;
    }

    div.result-box {
        position:relative;
        border: solid 1px transparent;
        padding:10px;
        margin: 20px auto 20px auto;
        width:90%;
        font-family:sans-serif;
        font-size:14px;
        transition: 0.2s border;
    }
    
    div.result-box:hover {
        border: solid 1px #999;
    }
    
    div.rb-main-info {
        width:23%;
        max-width:150px;
        float:left;
        
    }
    
    div.expensive-flag {
        display:inline-block;
        width:96px;
    }
    
    div.expensive-flag-text {
        display:inline-block;
        background-color:#ff944d;
        color:white;
        border-radius:5px;
        border:outset 1px #ffce99;
        padding:2px;
        font-weight:bolder;
        font-family:sans-serif;
        box-shadow: 1px 1px 3px rgba(30,30,5,0.5);
    }
    
    div.view-flight-button {
        display:inline-block;
        background-color:#45106e;
        border-radius:5px;
        border:outset 1px #45106e;
        margin:10px 0px 20px 10px;
        padding:5px;
        transition: 0.2s background;
    }
    
    div.view-flight-button:hover {
        display:inline-block;
        background-color:#8745b3;
        border-radius:5px;
        border:outset 1px #8745b3;
        margin:10px 0px 20px 10px;
        padding:5px;
    }
    div.view-flight-button a{
        color:white;
        text-decoration:none;
        font-weight:bold;
        padding:5px;
    }
    
   
    
    div.flight-carrier {
        display:block;
        font-size:14px;
        color: #444;
        padding: 0px 0px 0px 5px;
    }
    
    div.flight-time {
        display:inline-block;
        padding:5px;
    }
    
    div.sb-container {
        display:inline-block;
        width:100%;
        float:left;
        padding:10px 0px 10px 0px;
    }
    
    span.flight-destination {
        font-weight:bold;
    }
    
    span.flight-grey {
        padding:0px 5px 0px 5px;
        color:#777
    }
    
    span.flight-stops {
        
        color:#45106e;
    }
    
    div.flight-time.stops {
        
    }
    
    header.flight-search-header {
        border: solid 1px black;
        width:100%;
        position:relative;
        min-height:50px;
    }
    
    header div.search-header-cities {
        display:inline-block;
        padding:10px;
    }
    
    
    div.flight-extra-info {
        clear:both;
        width:100%;
        display:block;
        border:solid 1px black;
    }
    
    button.change-flight, input.change-flight {
        padding:5px 15px 5px 15px;
        border-radius:5px;
        background-color:#45106e;
        border: 1px groove #8745b3;
        color:white;
        font-size:14px;
        font-family:sans-serif;
        font-weight:bold;
        cursor:pointer;
    }
    
    button.change-flight:hover, input.change-flight:hover {
        background-color:#8745b3;
        border: 1px outset #8745b3;
    }
    
    div.flight-header {
        position:relative;
        display:block;
    }
    
    div.form-short-col-3 {
        width:15%;
        display:inline-block;
    }
    
    div.form-short-col-2 {
        width:100%;
        display:block;
        position:
    }
    
    button.passengers {
        
    }
    
    div.short-form {
        display:none;
    }
    
    div.passengers-container {
        display:inline-block;
        position:relative;
    }
    
    label.passengers {
        width:40%;
        display:inline-block;
    }
    
    select.passengers {
        width:40%;
        display:inline-block;
    }
    
    div.passengers {
        position:absolute; 
        top:20px;
        left:0px;
        background-color:white;
        border:1px solid black;
        width:200px;
        z-index:1;
        font-family:sans-serif;
        font-size:12px;
    }
    
    form div.short-form-group input {
        padding:4px 5px;
        font-size:12px;
        border: solid 1px transparent;
        border-color: #45106e #8828ab #45106e;
        border-radius:4px;
        width:80%;
    }
    
    div.extra-information {
        clear:left;
        display:none;
    }
    
    div.extra-info-body {
        
    }
    
    div.result-box:focus div.extra-information{
        display:block;
    }
    
    div.extra-info-menu {
        display:inline-block;
        padding:10px 20px 10px 20px;
    }
    
    div.extra-info-menu.on {
        display:inline-block;
        margin-bottom: -1px;
        padding:10px 20px 10px 20px;
        border-top:solid 1px #BBB;
        border-left:solid 1px #BBB;
        border-right:solid 1px #BBB;
        border-bottom:solid 5px #FFF;
    }
    
    div.extra-info-menu.off {
        display:inline-block;
        margin-bottom: 0px;
        padding:10px 20px 10px 20px;
        border-top:solid 1px #FFF;
        border-left:solid 1px #FFF;
        border-right:solid 1px #FFF;
        border-bottom:solid 1px transparent;
    }
    
    div.flight-right-col {
        display:block;
        width:77%;
        float:left;
    }
    
    div.extra-info-header {
        display:block;
        clear:left;
        border-bottom: solid 1px #BBB;
    }
    
    h2.extra-info-title {
        clear:left;
        border-bottom:solid 1px #CCC;
        margin: 10px auto 0px auto;
        padding-left: 5px;
        font-size:16px;
        color:#555;
    }
    
    div.flight-fare-row {
        display:block;
        font-size:14px;
        color: #444;
        padding: 0px 0px 0px 5px;
    }
    
    div.flight-fare-left-col {
        display:inline-block;
        width:20%;
        text-align:left;
    }
    div.flight-fare-right-col {
        display:inline-block;
        width:40%;
        text-align:left;
    }
    
    div.extra-info-details-wrapper.on {
        display:block;
    }
    div.extra-info-details-wrapper.off {
        display:none;
    }
    
    div.extra-info-fares-wrapper.on {
        display:block;
    }
    div.extra-info-fares-wrapper.off {
        display:none;
    }
</style>

<div class='container clearfix'>
    <div class='side-left'>
        <div class='side-content'>
        </div>
        <div class='side-ads'>
            ads go here
        </div> 
    </div>
    
    <% if @response["trips"]["tripOption"] != nil %>
    <div class='col-10 middle clearfix'>
    <header class='flight-search-header'>
        <div class='flight-header'>
            <div class='search-header-cities'>
                <span><%=@origin%></span>
                <span>&#8596;</span>
                <span><%=@destination%></span>
            </div> 

            <div class='search-header-cities'>
                <span><%= @departure_first %></span>
                &#8594;
                <span><%= @departure_last %></span>
            </div> 

            <button class='change-flight'>
                Change
            </button>
        </div>
        <div class='short-form'>
            <%= form_tag search_path, method: :GET, role: "search"  %>
                    <div class='short-form-group'>
                        <div class='form-col-xl-full off' id='flights_title'>
                            <h3 class='flight-search-title'>Flight 1</h3>
                        </div>
                        <div class='form-short-col-3'>
                            <%= text_field_tag 'city', nil, placeholder: 'city or airport', class: "query", name:"query[query1[query_1_1]]", id: 'query1' %>
                        </div>
                        <span>&#8594; </span>
                        <div class='form-short-col-3'>
                            <%= text_field_tag 'city', nil, placeholder: 'city or airport', class: "query", name:"query[query1[query_1_2]]", id: 'query2' %>
                        </div>

                        <div class='form-short-col-3'>
                            <%= date_field_tag(:query_1_date_l, Date.today) %>
                        </div>
                        
                        <div class='form-short-col-3 on' id='returning'>
                            <%= label_tag 'returing', 'Returning' %>
                            <%= date_field_tag(:query_2_date_r, Date.today) %>
                        </div>
                        <div class='passengers-container'>
                            <button type='button' onclick="" class='passengers'>Passengers</button>
                            <div class='passengers off'>
                                <div class='form-short-col-2'>
                                    <%= label_tag 'adult', 'Adult (18+)' %>             
                                    <%= select_tag "adult", options_for_select([ 1, 2, 3, 4, 5, 6], "1"), class: "passengers" %>
                                </div>

                                <div class='form-short-col-2'>
                                    <%= label_tag 'child', 'Child (0-17)' %>             
                                    <%= select_tag "child", options_for_select([ 0, 1, 2, 3, 4, 5, 6], "0"), class: "passengers" %>
                                </div>

                                <div class='form-short-col-2'>
                                    <%= label_tag 'Dogs', 'Dogs' %>             
                                    <%= select_tag "dogs", options_for_select([ 0, 1, 2, 3], "0"), class: "passengers" %>
                                </div>
                                <div class='form-short-col-2'>
                                    <%= label_tag 'Cats', 'Cats' %>             
                                    <%= select_tag "cats", options_for_select([ 0, 1, 2, 3], "0"), class: "passengers" %>
                                </div>
                                <div class='form-short-col-2'>
                                    <%= label_tag 'Other', 'Other' %>             
                                    <%= select_tag "other_pet", options_for_select([ 0, 1, 2, 3], "0"), class: "passengers" %>
                                </div>
                            </div>
                        </div>
                        
                        <div id='container'>
                            <div class='test'>
                            </div>
                        </div>
                        <div class='form-col-xl-full'>
                            <button type='button' id='button'>Add flight</button>
                        </div>
                        <div class='form-col-xl-full'>
                            <%= label_tag 'advanced_options', 'Advanced Search', class: 'l-small' %>
                            <%= hidden_field(:type, :pass_confirm, :value => "n") %>
                            <%= submit_tag 'Search', class: 'change-flight' %>
                        </div>
                    </div>
                </form>
            <button class='change-flight'>
                Search
            </button>
        </div>
    </header>
    <% if @response != "" %>
        <% @response["trips"]["tripOption"].each do |x|%>
            <div class='result-box clearfix'>
                <div class="box-header">

                </div>
                <div class='rb-main-info'>
                    <div class='rb-price'>
                        <span class='price'>
                            £<%= x["saleTotal"][3..8]%>
                        </span>
                    </div>
                    <div class='expensive-flag'>
                        <% @price_comp = @baseprice.to_i * 2
                       if @price_comp < x["saleTotal"][3..8].to_i %>
                        <div class='expensive-flag-text'>
                            EXPENSIVE
                        </div>
                        <% end %>
                    </div>
                    
                    <div class='paw-icon'>

                    </div>
                    <div class='view-flight-button'>
                        <a href="/search_show?"> View Flight</a>
                       <!-- <%= link_to 'View Flight', search_show_path() %> -->
                    </div>
                </div>
                <div class='carrier-icon'>
                </div>
                <div class='flight-right-col'>
                    <% x["slice"].each do |s| %>
                    <% if s["segment"][1] != nil 
                    j = s["segment"].count - 1 
                    k = 0 %>

                    <div class='flight-time sb-container'>
                        <div class='flight-carrier'>
                            <%= @carrier[s["segment"][0]["flight"]["carrier"]] %>
                        </div>
                        <div class='flight-time flightDepart'> 
                            <span class='flight-destination'><%= s["segment"][0]["leg"][0]["departureTime"][11..15]%></span> - <%=d = s["segment"][0]["leg"][0]["origin"] %>
                        </div>
                        <div class='flight-time arrow'>&#8594;</div>
                        <div class='flight-time flightDepart'>
                            <span class='flight-destination'><%= s["segment"][j]["leg"][0]["arrivalTime"][11..15]%></span> - <%=g = s["segment"][j]["leg"][0]["destination"]%>
                        </div>
                        <div class='flight-time flight-duration'>
                            <% @total_d =  0
                                while k < x["slice"].count do 
                                 @total_d = @total_d + x["slice"][k]["segment"][0]["duration"]
                                 if s["segment"][0]["connectionDuration"] != nil
                                      @total_d_c = @total_d + s["segment"][0]["connectionDuration"]
                                 end  
                                %>
                                <% k = k + 1 %>
                                <% end %>
                            <span class='flight-grey'><%= (@total_d/60).floor %>hr <%= (@total_d % 60 ) %>m</span>
                        </div>

                        <div class='flight-time'>
                            <span class='flight-grey'><% date = Date.parse(s["segment"][0]["leg"][0]["departureTime"][0..9]) %> <%= date.strftime("#{date.day.ordinalize}, %b %Y") %></span> 
                        </div>
                        <div class='flight-time stops'>
                           <span class='flight-stops'>
                               <% if s["segment"].count == 1 %>
                               non-stop
                               <% elsif s["segment"].count == 2 %>
                               <%= s["segment"].count - 1 %> stop
                               <% elsif s["segment"].count > 2 %>
                               <%= s["segment"].count - 1 %> stops
                               <% end %>
                            </span>
                        </div>
                    </div>  

                    <% else %>

                    <% @total_d =  0
                        k = 0
                    while k < x["slice"].count do 
                     @total_d = @total_d + x["slice"][k]["duration"]
                     if x["slice"][k]["segment"][0]["connectionDuration"] != nil
                          @total_d = @total_d + x["slice"][k]["segment"][0]["connectionDuration"]
                     end 
                    %>
                    <% k = k + 1 %>
                    <% end %>
                    <% s["segment"].each do |y| %>
                        <div class='flight-time sb-container'>
                            <div class='flight-carrier'>
                                <%= @carrier[y["flight"]["carrier"]] %>
                            </div>
                            <div class='flight-time flightDepart'>
                                <span class='flight-destination'><%= y["leg"][0]["departureTime"][11..15]%></span> - <%=d = y["leg"][0]["origin"] %> 
                            </div>
                            <div class='flight-time arrow'>&#8594;</div>
                            <div class='flight-time flightDepart'>
                                <span class='flight-destination'><%= y["leg"][0]["arrivalTime"][11..15]%></span> - <%=g = y["leg"][0]["destination"]%>
                            </div>

                            <div class='flight-time flight-duration'>
                                <span class='flight-grey'><%= (y["duration"]/60).floor %>hr <%= (y["duration"] % 60 ) %>m</span>
                            </div>

                            <div class='flight-time'>
                                <span class='flight-grey'><% date = Date.parse(y["leg"][0]["departureTime"][0..9]) %> <%= date.strftime("#{date.day.ordinalize}, %b %Y") %></span> 
                            </div>

                            <div class='flight-time stops'>
                               <span class='flight-stops'>
                                   <% if s["segment"].count == 1 %>
                                   non-stop
                                   <% elsif s["segment"].count == 2 %>
                                   <%= s["segment"].count - 1 %> stop
                                   <% elsif s["segment"].count > 2 %>
                                   <%= s["segment"].count - 1 %> stops
                                   <% end %>
                                </span>
                            </div>

                        </div>  
                    <% end %> 
                    <% end %>

                <% end %>
                    <div class='extra-information'>
                        <div class='extra-info-header'>
                            <div class='extra-info-menu on' onclick='show_details()'>
                                Details  
                            </div>
                            <div class='extra-info-menu off' onclick='show_fares()'>
                                Fares
                            </div>
                        </div>
                        <div class='extra-info-details-wrapper on'>
                        <% i = 0 %>
                        <% x["slice"].each do |s| %>
                        <% if i == 0 %>
                            <h2 class='extra-info-title'>
                                Depart
                            </h2>
                            <% elsif i == 1 %>
                            <h2 class='extra-info-title'>
                                Return
                            </h2>
                            <% end %>
                        <% s["segment"].each do |y| %>
                        <div class='extra-info-body'>
                            <div class='flight-time sb-container'>
                                <div class='flight-carrier'>
                                    <%= @carrier[y["flight"]["carrier"]] %>
                                </div>
                                <div class='flight-time flightDepart'>
                                    <span class='flight-destination'><%= y["leg"][0]["departureTime"][11..15]%></span> - <%=d = y["leg"][0]["origin"] %> 
                                </div>
                                <div class='flight-time arrow'>&#8594;</div>
                                <div class='flight-time flightDepart'>
                                    <span class='flight-destination'><%= y["leg"][0]["arrivalTime"][11..15]%></span> - <%=g = y["leg"][0]["destination"]%>
                                </div>

                                <div class='flight-time flight-duration'>
                                    <span class='flight-grey'><%= (y["duration"]/60).floor %>hr <%= (y["duration"] % 60 ) %>m</span>
                                </div>

                                <div class='flight-time'>
                                    <span class='flight-grey'><% date = Date.parse(y["leg"][0]["departureTime"][0..9]) %> <%= date.strftime("%a, %d %b") %></span>
                                </div>

                            </div>
                        </div>
                        <% end %> 

                        
                        <% i = i + 1 %>
                        <% end %>
                        </div>
                        <div class='extra-info-fares-wrapper off'>
                            <h2 class='extra-info-title'>
                                Known fares
                            </h2>
                            <div class='flight-fare-row'>
                                <div class='flight-fare-left-col'>
                                    <span>Flight Price:</span>
                                </div>
                                <div class='flight-fare-right-col'>
                                    <span>£<%= x["pricing"][0]["saleFareTotal"][3..10] %></span>
                                </div>
                            </div>
                            <div class='flight-fare-row'>
                                <div class='flight-fare-left-col'>
                                    <span>Tax:</span>
                                </div>
                                <div class='flight-fare-right-col'>
                                    <span>£<%= x["pricing"][0]["saleTaxTotal"][3..10] %></span>
                                </div>
                            </div>
                            <div class='flight-fare-row'>
                                <div class='flight-fare-left-col'>
                                    <span>Ticket Total:</span>
                                </div>
                                <div class='flight-fare-right-col'>
                                    <span>£<%= x["pricing"][0]["saleTotal"][3..10] %></span>
                                </div>
                            </div>
                            <div class='flight-fare-row'>
                                <div class='flight-fare-left-col'>
                                    <span>Last chance to buy:</span>
                                </div>
                                <div class='flight-fare-right-col'>
                                    <span><% lctb = Date.parse(x["pricing"][0]["latestTicketingTime"][0..9]) %> <%= lctb.strftime("%a, %d %b") %> at <%= x["pricing"][0]["latestTicketingTime"][11..15] %></span>
                                </div>
                            </div>
                           
                            <% if x["pricing"][0]["refundable"] == "TRUE" %>
                            <div class='flight-fare-row'>
                                <div class='flight-fare-left-col'>
                                </div>
                                <div class='flight-fare-right-col'>
                                    <span>Refundable</span>
                                </div>
                            </div>
                            <% else %>
                            <div class='flight-fare-row'>
                                <div class='flight-fare-left-col'>
                                </div>
                                <div class='flight-fare-right-col'>
                                    <span>Non-Refundable</span>
                                </div>
                            </div>
                            <%end%>
                        </div>
                    </div>
            </div>   
    </div>
        <% end %>
    <% end %> 
    </div>
    <div class='side-right'>
        <div class='side-ads'>
            ads go here
        </div>
    </div>
    <% else %>
    <div class='col-10 middle clearfix'>
        <p>Your search result came up empty, Please try a different search</p>
        <p>Suggested searches</p>
        <span>Flying from</span>
        <ul class='flight-suggestions'>
            <% @test.each do |x| %>
            <% if x["iata"] != nil %>
            <li>
                <%= x["name"] %>, (<%= x["iata"] %>), <%= x["city"] %>, <%= x["country"] %>
            </li>
            <% end %>
            <% end %>
        </ul>
        
        <span>Going to</span>
        <ul class='flight-suggestions'>
            <% @testt.each do |x| %>
            <% if x["iata"] != nil %>
            <li>
                <%= x["name"] %>, (<%= x["iata"] %>), <%= x["city"] %>, <%= x["country"] %>
            </li>
            <% end %>
            <% end %>
        </ul>
    </div>
    <div class='side-right'>
        <div class='side-ads'>
            ads go here
        </div>
    </div>
    <% end %>
</div>

<%= render 'pages/footer'%>